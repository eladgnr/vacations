{% extends "vacations/base.html" %}
{% block title %}{{ country_name }} Vacations{% endblock %}

{% block content %}
<div class="container py-4">
    <h1 class="mb-4">Vacation Options in {{ country_name }}</h1>

    <div class="row">
        {% for vacation in vacation_options %}
        <div class="col-md-6 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="position-relative">
                    {% if vacation.image %}
                    <img src="{{ vacation.image.url }}" class="card-img-top" alt="{{ vacation.title }}">
                    {% endif %}

                    <!-- Likes/Unlikes Counter (top-right) -->
                    <div class="position-absolute top-0 end-0 m-2 p-1 bg-light border rounded text-center small"
                        style="width: 60px;">
                        <div>üëç {{ vacation.likes }}</div>
                        <div>üëé {{ vacation.unlikes }}</div>
                    </div>

                    <!-- Vote Buttons (bottom-left with grey box) -->
                    <div class="position-absolute bottom-0 start-0 m-2 p-1 bg-light border rounded text-center">
                        {% if user.is_authenticated %}
                        {% if not user.is_staff %}

                        <form method="post" action="{% url 'vacation_like' vacation.id %}">
                            {% csrf_token %}
                            <button type="submit" name="is_like" value="true"
                                class="btn btn-sm me-1 {% if vacation.user_vote is True %}btn-success{% else %}btn-outline-success{% endif %}">üëç</button>
                            <button type="submit" name="is_like" value="false"
                                class="btn btn-sm {% if vacation.user_vote is False %}btn-danger{% else %}btn-outline-danger{% endif %}">üëé</button>
                        </form>
                        {% else %}
                        <div class="text-muted small">Admins cannot vote</div>
                        {% endif %}
                        {% endif %}
                    </div>




                </div>
                <div class="card-body">
                    <h5 class="card-title">{{ vacation.title }}</h5>
                    {% if vacation.description %}
                    <p class="card-text">{{ vacation.description }}</p>
                    {% else %}
                    <p class="text-muted">No description provided.</p>
                    {% endif %}
                    {% if user.is_staff %}
                    <a href="/admin/vacations/vacation/" class="btn btn-outline-primary btn-sm mt-2">
                        ‚úèÔ∏è Edit This Vacation
                    </a>
                    {% endif %}


                    <a href="{% url 'choose_vacation' vacation.id %}" class="btn btn-success btn-sm mt-2">
                        Click here to choose your vacation at {{ vacation.title }}
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <a href="{% url 'home' %}" class="btn btn-link mt-3">
        <i class="bi bi-arrow-left-circle"></i> Back to Home
    </a>
</div>
{% endblock %}